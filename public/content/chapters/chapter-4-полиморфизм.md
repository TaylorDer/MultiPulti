# ПОЛИМОРФИЗМ




**Полиморфизм** – возможность с помощью одного имени обозначать
операции из различных классов (но относящихся к общему суперклассу).
Вызов обслуживания по полиморфному имени приводит к исполнению
одной из некоторого набора операций.
Рассмотрим различные реализации процедуры «Записывать». Для
класса «ПараметрыПолета» реализация имеет вид
procedure «Записывать» (in out ПараметрыПолета) is
begin – записывать имя параметра; – записывать отметку времени;
end Записывать.
В классе «Кабина» предусмотрена другая реализация процедуры
procedure Записывать (in out Кабина) is
begin
Записывать (ПараметрыПолета); – вызов метода суперкласса; – записывать значение давления; – записывать процентное содержание кислорода; – записывать значение температуры;
end Записывать.
Предположим, что мы имеем по экземпляру каждого из этих двух
классов:
В полете: ПараметрыПолета:= Инициировать;
В кабине: Кабина:= Инициировать (768. 21. 20);
Предположим также, что имеется свободная процедура:
procedure СохранятьНовыеДанные (d: in out
ПараметрыПолета'class; t: БортовоеВремя) is
begin
if ТекущееВремя(d) >= t then
Записывать (d): – диспетчирование с помощью тега
end if;
end СохранятьНовыеДанные.
Что случится при выполнении следующих операторов?
СохранятьНовыеДанные (Вполете, БортовоеВремя (60));
СохранятьНовыеДанные (Вкабине, БортовоеВремя (120)).
Каждый из операторов вызывает операцию «Записывать» нужного
класса. В первом случае диспетчеризация приведёт к операции «Записы
вать» из класса «ПараметрыПолета». Во втором случае будет выполняться
операция из класса «Кабина». Как видим, в свободной процедуре пере
менная d может обозначать объекты разных классов, значит, здесь запи
сан вызов полиморфной операции.
**АГРЕГАЦИЯ**
Отношения агрегации между классами аналогичны отношениям аг
регации между объектами.
Повторим пример с описанием класса «КонтроллерУгла»:
with **Класс** «ГрафикРазворота». **Класс** «РегуляторУгла»;
use **Класс** «ГрафикРазворота», **Класс** «РегуляторУгла»;
Package **Класс** «КонтроллерУгла» is
type указатель наГрафик is access all ГрафикРазворота;
type КонтроллерУгла is tagged private:
procedure Обрабатывать (in out КонтроллерУгла;
yгол: указатель на График);
function Запланировано (КонтроллерУгла;
угол: указатель на График) return Секунда;
private
type КонтроллерУгла is tagged record;
регулятор: РегуляторУгла;
…
end **Класс** «КонтроллерУгла».
КонтроллерУгла
РегуляторУгла
Рис. 2.13. Отношение агрегации по величине (композиция)
Видим, что **класс** «КонтроллерУгла» является агрегатом, а экземпляр
класса «РегуляторУгла» – это одна из его частей. **Агрегация** здесь опреде
лена как включение по величине. Это пример физического включения,
означающий, что **объект** «Регулятор» не существует независимо от вклю
чающего его экземпляра КонтроллераУгла. Время жизни этих двух объек
тов неразрывно связано.
Графическая иллюстрация отношения агрегации по величине (ком
позиции) представлена на рис. 2.13.
Возможен косвенный тип агрегации – включение по ссылке. Если мы
запишем в приватной части класса «КонтроллерУгла»:
…
private
type указатель на РегуляторУгла is access all РегуляторУгла;
type КонтроллерУгла is tagged record;
регулятор: указатель на РегуляторУгла;
…
end **Класс** «КонтроллерУгла»;
то регулятор как часть контроллера будет доступен косвенно.
Теперь **сцепление** объектов уменьшено. Экземпляры каждого класса
создаются и уничтожаются независимо.
Ещё два примера агрегации по ссылке и по величине (композиции)
приведены на рис. 2.14. Здесь показаны **класс**-агрегат «Дом» и **класс**
агрегат «Окно», причём указаны роли и множественность частей агрегата
(соответствующие пометки имеют линии отношений).
Как показано на рисунке 2.15, возможны и другие формы представ
ления агрегации по величине – композиции. Композицию можно отобра
зить графическим вложением символов частей в символ агрегата (левая
часть рис. 2.15). Вложенные части демонстрируют свою множественность
(мощность, кратность) в правом верхнем углу своего символа. Если метка
множественности опущена, по умолчанию считают, что её значение «мно
го». Вложенный элемент может иметь роль в агрегате. Используется син
таксис
роль : имя Класса.
Рис. 2.14. **Агрегация** классов
Рис. 2.15. Формы представления композиции
Эта роль соответствует той роли, которую играет часть в неявном (в
этой нотации) отношении композиции между частью и целым (агрегатом).
Как представлено в правой части рис. 2.15, свойства (атрибуты)
класса находятся в отношении композиции между всем классом и его
элементами-свойствами. Тем не менее в общем случае свойства должны
иметь примитивные значения (числа, строки, даты), а не ссылаться на
другие классы, так как в «атрибутной» нотации не видны другие отноше
ния классов-частей. Кроме того, свойства классов не могут находиться в
совместном использовании несколькими классами.