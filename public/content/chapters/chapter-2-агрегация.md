# АГРЕГАЦИЯ

Отношения агрегации между классами аналогичны отношениям агрегации между объектами.

Повторим пример с описанием класса «КонтроллерУгла»:

with Класс «ГрафикРазворота». Класс «РегуляторУгла»; use Класс «ГрафикРазворота», Класс «РегуляторУгла»; Package Класс «КонтроллерУгла» is type указатель наГрафик is access all ГрафикРазворота; type КонтроллерУгла is tagged private:

procedure Обрабатывать (in out КонтроллерУгла; yгол: указатель на График);

function Запланировано (КонтроллерУгла; угол: указатель на График) return Секунда; private type КонтроллерУгла is tagged record; регулятор: РегуляторУгла;

…

end Класс «КонтроллерУгла».

![Рис. 2.13. Отношение агрегации по величине (композиция)](/images/milovanov/ris_2_13.jpg)

**Рис. 2.13. Отношение агрегации по величине (композиция)**

Видим, что класс «КонтроллерУгла» является агрегатом, а экземпляр класса «РегуляторУгла» – это одна из его частей. Агрегация здесь определена как включение по величине. Это пример физического включения, означающий, что объект «Регулятор» не существует независимо от включающего его экземпляра КонтроллераУгла. Время жизни этих двух объектов неразрывно связано.

Графическая иллюстрация отношения агрегации по величине (композиции) представлена на рис. 2.13.

Возможен косвенный тип агрегации – включение по ссылке. Если мы запишем в приватной части класса «КонтроллерУгла»:

…

private type указатель на РегуляторУгла is access all РегуляторУгла; type КонтроллерУгла is tagged record; регулятор: указатель на РегуляторУгла;

…

end Класс «КонтроллерУгла»;

то регулятор как часть контроллера будет доступен косвенно.

Теперь сцепление объектов уменьшено. Экземпляры каждого класса создаются и уничтожаются независимо.

Ещё два примера агрегации по ссылке и по величине (композиции) приведены на рис. 2.14. Здесь показаны класс-агрегат «Дом» и классагрегат «Окно», причём указаны роли и множественность частей агрегата (соответствующие пометки имеют линии отношений).

Как показано на рисунке 2.15, возможны и другие формы представления агрегации по величине – композиции. Композицию можно отобразить графическим вложением символов частей в символ агрегата (левая часть рис. 2.15). Вложенные части демонстрируют свою множественность (мощность, кратность) в правом верхнем углу своего символа. Если метка множественности опущена, по умолчанию считают, что её значение «много». Вложенный элемент может иметь роль в агрегате. Используется синтаксис

роль : имя Класса.

![Рис. 2.14. Агрегация классов](/images/milovanov/ris_2_14.jpg)

**Рис. 2.14. Агрегация классов**

![Рис. 2.15. Формы представления композиции](/images/milovanov/ris_2_15.jpg)

**Рис. 2.15. Формы представления композиции**

Эта роль соответствует той роли, которую играет часть в неявном (в этой нотации) отношении композиции между частью и целым (агрегатом).

Как представлено в правой части рис. 2.15, свойства (атрибуты) класса находятся в отношении композиции между всем классом и его элементами-свойствами. Тем не менее в общем случае свойства должны иметь примитивные значения (числа, строки, даты), а не ссылаться на другие классы, так как в «атрибутной» нотации не видны другие отношения классов-частей. Кроме того, свойства классов не могут находиться в совместном использовании несколькими классами.
