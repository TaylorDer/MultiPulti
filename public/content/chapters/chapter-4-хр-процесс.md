# ХР-ПРОЦЕСС

Экстремальное программирование (eXtreme Programming, XP) – облегчённый (подвижный) процесс (или методология) [24]. ХР-процесс ориентирован на группы малого и среднего размера, строящие программное обеспечение в условиях неопределенных или быстро изменяющихся требований. ХР-группу образуют до 10 сотрудников, которые размещаются в одном помещении.

Основная идея ХР – устранить высокую стоимость изменения, характерную для приложений с использованием объектов, паттернов* и реляционных баз данных. Поэтому ХР-процесс должен быть высокодинамичным процессом. ХР-группа имеет дело с изменениями требований на всём протяжении итерационного цикла разработки, причём цикл состоит из очень коротких итераций. Четырьмя базовыми действиями в ХР-цикле являются: кодирование, тестирование, выслушивание заказчика и проектирование. Динамизм обеспечивается с помощью четырёх характеристик: непрерывной связи с заказчиком (и в пределах группы), простоты (всегда выбирается минимальное решение), быстрой обратной связи (с помощью модульного и функционального тестирования), смелости в проведении профилактики возможных проблем.

Большинство принципов, поддерживаемых в ХР (минимальность, простота, эволюционный цикл разработки, малая длительность итерации, участие пользователя, оптимальные стандарты кодирования и т.д.), продиктованы здравым смыслом и применяются в любом упорядоченном процессе. Просто в ХР эти принципы, как показано в табл. 4.2, достигают «экстремальных значений».

## 4.2. Экстремумы в экстремальном программировании

| Практика здравого смысла | ХР-экстремум | ХР-реализация |
| --- | --- | --- |
| Проверки кода | Код проверяется всё время | Парное программирование |
| Тестирование | Тестирование выполняется всё время, даже с помощью заказчиков | Тестирование модуля, функциональное тестирование |

*Продолжение табл. 4.2*

| Практика здравого смысла | ХР-экстремум | ХР-реализация |
| --- | --- | --- |
| Проектирование | Проектирование является частью ежедневной деятельности каждого разработчика | Реорганизация (refactoring) |
| Простота | Для системы выбирается простейшее проектное решение, поддерживающее её текущую функциональность | Самая простая вещь, которая могла бы работать |
| Архитектура | Каждый постоянно работает над уточнением архитектуры | Метафора |
| Тестирование интеграции | Интегрируется и тестируется несколько раз в день | Непрерывная интеграция |
| Короткие итерации | Итерации являются предельно короткими, продолжаются секунды, минуты, часы, а не недели, месяцы или годы | Игра планирования |
|  |  |  |

Тот, кто принимает принцип «минимального решения» за хакерство, ошибается, в действительности ХР – строго упорядоченный процесс. Простые решения, имеющие высший приоритет, в настоящее время рассматриваются как наиболее ценные части системы, в отличие от проектных решений, которые пока не нужны, а могут (в условиях изменения требований и операционной среды) и вообще не понадобиться.

Базис ХР образуют перечисленные ниже двенадцать методов.

1. Игра планирования (Planning game) – быстрое определение области действия следующей реализации путём объединения деловых приоритетов и технических оценок. Заказчик формирует область действия, приоритетность и сроки с точки зрения бизнеса, а разработчики оценивают и прослеживают продвижение (прогресс).
1. Частая смена версий (Small releases) – быстрый запуск в производство простой системы. Новые версии реализуются в очень коротком (двухнедельном) цикле.
1. Метафора (Metaphor) – вся разработка проводится на основе простой, общедоступной истории о том, как работает вся система.
1. Простое проектирование (Simple design) – проектирование выполняется настолько просто, насколько это возможно в данный момент.
1. Тестирование (Testing) – непрерывное написание тестов для модулей, которые должны выполняться безупречно; заказчики пишут тесты для демонстрации законченности функций. «Тестируй, а затем кодируй» означает, что входным критерием для написания кода является «отказавший» тестовый вариант.
1. Реорганизация (Refactoring) – система реструктурируется, но её поведение не изменяется; цель – устранить дублирование, улучшить взаимодействие, упростить систему или добавить в неё гибкость.
1. Парное программирование (Pair programming) – весь код пишется двумя программистами, работающими на одном компьютере.
1. Коллективное владение кодом (Collective ownership) – любой разработчик может улучшать любой код системы в любое время.
1. Непрерывная интеграция (Continuous integration) – система интегрируется и строится много раз в день по мере завершения каждой задачи. Непрерывное регрессионное тестирование, т.е. повторение предыдущих тестов гарантирует, что изменения требований не приведут к регрессу функциональности.
1. 40-часовая неделя (40-hour week) – как правило, работают не более 40 часов в неделю. Нельзя удваивать рабочую неделю за счёт сверхурочных работ.
1. Локальный заказчик (On-site customer) – в группе всё время должен находиться представитель заказчика, действительно готовый отвечать на вопросы разработчиков.
1. Стандарты кодирования (Coding standards) – должны выдерживаться правила, обеспечивающие одинаковое представление программного кода во всех частях программной системы.
Игра планирования и частая смена версий зависят от заказчика, обеспечивающего набор «историй» (коротких описаний), характеризующих работу, которая будет выполняться для каждой версии системы. Версии генерируются каждые две недели, поэтому разработчики и заказчик должны прийти к соглашению о том, какие истории будут осуществлены в пределах двух недель. Полную функциональность, требуемую заказчику, характеризует пул историй; но для следующей двухнедельной итерации из пула выбирается подмножество историй, наиболее важное для заказчика. В любое время в пул могут быть добавлены новые истории, таким образом, требования могут быстро изменяться. Однако процессы двухнедельной генерации основаны на наиболее важных функциях, входящих в текущий пул, следовательно, изменчивость управляется. Локальный заказчик обеспечивает поддержку этого стиля итерационной разработки.

«Метафора» обеспечивает глобальное «видение» проекта. Она могла бы рассматриваться как высокоуровневая архитектура, но ХР подчёркивает желательность проектирования при минимизации проектной документации. Точнее говоря, ХР предлагает непрерывное перепроектирование (с помощью реорганизации), при котором нет нужды в детализированной проектной документации, а для инженеров сопровождения единственным надёжным источником информации является программный код. Обычно после написания кода проектная документация выбрасывается. Проектная документация сохраняется только в том случае, когда заказчик временно теряет способность придумывать новые истории. Тогда систему помещают в «нафталин» и пишут руководство страниц на пять-десять по «нафталиновому» варианту системы. Использование реорганизации приводит к реализации простейшего решения, удовлетворяющего текущую потребность. Изменения в требованиях заставляют отказываться от всех «общих решений».

Парное программирование – один из наиболее спорных методов в ХР, оно влияет на ресурсы, что важно для менеджеров, решающих, будет ли проект использовать ХР. Может показаться, что парное программирование удваивает ресурсы, но исследования доказали: парное программирование приводит к повышению качества и уменьшению времени цикла. Для согласованной группы затраты увеличиваются на 15%, а время цикла сокращается на 40…50%. Для Интернет-среды увеличение скорости продаж покрывает повышение затрат. Сотрудничество улучшает процесс решения проблем, улучшение качества существенно снижает затраты сопровождения, которые превышают стоимость дополнительных ресурсов по всему циклу разработки.

Коллективное владение означает, что любой разработчик может изменять любой фрагмент кода системы в любое время. Непрерывная интеграция, непрерывное регрессионное тестирование и парное программирование ХР обеспечивают защиту от возникающих при этом проблем.

«Тестируй, а затем кодируй» – эта фраза выражает акцент ХР на тестировании. Она отражает принцип, по которому сначала планируется тестирование, а тестовые варианты разрабатываются параллельно анализу требований, хотя традиционный подход состоит в тестировании «чёрного ящика». Размышление о тестировании в начале цикла жизни – хорошо известная практика конструирования ПО (правда, редко осуществляемая практически).

Основным средством управления ХР является метрика, а среда метрик – «большая визуальная диаграмма». Обычно используют 3–4 метрики, причём такие, которые видимы всей группе. Рекомендуемой в ХР метрикой является «скорость проекта» – количество историй заданного размера, которые могут быть реализованы в итерации.

При принятии ХР рекомендуется осваивать его методы по одному, каждый раз выбирая метод, ориентированный на самую трудную проблему группы. Конечно, все эти методы являются «не более чем правилами» – группа может в любой момент поменять их (если её сотрудники достигли принципиального соглашения по поводу внесённых изменений). Защитники ХР признают, что ХР оказывает сильное социальное воздействие, и не каждый может принять его. Вместе с тем, ХР – это методология, обеспечивающая преимущества только при использовании законченного набора базовых методов.

Рассмотрим структуру «идеального» ХР-процесса. Основным структурным элементом процесса является ХР-реализация, в которую многократно вкладывается базовый элемент – ХР-итерация. В состав ХР-реали- зации и ХР-итерации входят три фазы – исследование, блокировка, регулирование. Исследование (exploration) – это поиск новых требований (историй, задач), которые должна выполнять система. Блокировка (commitment) – выбор для реализации конкретного подмножества из всех возможных требований (иными словами, планирование). Регулирование

(steering) – проведение разработки, воплощение плана в жизнь.

ХР рекомендует: первая реализация должна иметь длительность

1. – 6 месяцев, продолжительность остальных реализаций – около двух

![Рис. 4.8. Идеальный ХР-процесс](/images/milovanov/ris_4_8.png)

**Рис. 4.8. Идеальный ХР-процесс**

месяцев, каждая итерация длится приблизительно две недели, а численность группы разработчиков не превышает 10 человек. ХР-процесс для проекта с семью реализациями, осуществляемый за 15 месяцев, показан на рис. 4.8.

Процесс инициируется начальной исследовательской фазой.

Фаза исследования, с которой начинается любая реализация и итерация, имеет клапан «пропуска», на этой фазе принимается решение о целесообразности дальнейшего продолжения работы.

Предполагается, что длительность первой реализации составляет

1. месяца, длительность второй – седьмой реализаций – 2 месяца. Вторая – седьмая реализации образуют период сопровождения, характеризующий природу ХР-проекта. Каждая итерация длится две недели, за исключением тех, которые относят к поздней стадии реализации – «запуску в производство» (в это время темп итерации ускоряется).
Наиболее трудна первая реализация – пройти за три месяца от обычного старта (скажем, отдельный сотрудник не зафиксировал никаких требований, не определены ограничения) к поставке заказчику системы промышленного качества.
